<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Period Tracker">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iNDAiIGZpbGw9InVybCgjZ3JhZGllbnQwX2xpbmVhcl8xXzEpIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MF9saW5lYXJfMV8xIiB4MT0iMCIgeTE9IjAiIHgyPSIxODAiIHkyPSIxODAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzY2N2VlYSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM3NjRiYTIiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8dGV4dCB4PSI5MCIgeT0iMTEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1zaXplPSI2MCIgZm9udC1mYW1pbHk9IkFyaWFsIj7wn4y4PC90ZXh0Pgo8L3N2Zz4K">
    <title>Period Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            margin: 0;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #5a67d8;
            margin-bottom: 30px;
            font-size: 2.5em;
            font-weight: 600;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(90, 103, 216, 0.1);
        }

        .card h2 {
            color: #4c51bf;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        input, select, button {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #5a67d8;
            box-shadow: 0 0 0 3px rgba(90, 103, 216, 0.1);
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(90, 103, 216, 0.3);
        }

        button:active {
            transform: translateY(0);
        }

        .period-entry {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .delete-btn {
            background: #e53e3e;
            padding: 8px 12px;
            font-size: 14px;
            min-width: auto;
        }

        .delete-btn:hover {
            background: #c53030;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-item {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #4c51bf;
            display: block;
        }

        .stat-label {
            color: #718096;
            margin-top: 5px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 20px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            border: 2px solid transparent;
        }

        .calendar-day:hover {
            transform: scale(1.1);
            border-color: #5a67d8;
        }

        .calendar-day.other-month {
            color: #cbd5e0;
            cursor: default;
        }

        .calendar-day.other-month:hover {
            transform: none;
            border-color: transparent;
        }

        .calendar-header {
            font-weight: bold;
            color: #4c51bf;
            text-align: center;
            padding: 10px;
            background: #edf2f7;
            border-radius: 8px;
        }

        .period-day {
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            color: white;
        }

        .predicted-day {
            background: linear-gradient(135deg, #ffd93d, #ff6b9d);
            color: white;
            opacity: 0.8;
        }

        .today {
            border: 3px solid #5a67d8;
            font-weight: bold;
        }

        .empty-state {
            text-align: center;
            color: #718096;
            font-style: italic;
            padding: 40px 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
                margin: 5px;
                border-radius: 15px;
            }

            .input-group {
                flex-direction: column;
                align-items: stretch;
            }

            h1 {
                font-size: 2em;
                margin-bottom: 20px;
            }
            
            .card {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .calendar-day {
                font-size: 16px;
                min-height: 44px;
            }
            
            button {
                min-height: 44px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üå∏ Period Tracker</h1>
        
        <div class="card">
            <h2>Calendar View - Click to Log Period Days</h2>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <button onclick="previousMonth()" style="padding: 8px 16px; font-size: 14px;">‚Üê Previous</button>
                <h3 id="currentMonthYear" style="margin: 0; color: #4c51bf;"></h3>
                <button onclick="nextMonth()" style="padding: 8px 16px; font-size: 14px;">Next ‚Üí</button>
            </div>
            <div class="calendar" id="calendar"></div>
            <div style="margin-top: 15px; display: flex; gap: 20px; justify-content: center; font-size: 14px;">
                <span><span style="display: inline-block; width: 16px; height: 16px; background: linear-gradient(135deg, #ff6b6b, #ff8e8e); border-radius: 4px; margin-right: 8px;"></span>Period Day</span>
                <span><span style="display: inline-block; width: 16px; height: 16px; background: linear-gradient(135deg, #ffd93d, #ff6b9d); opacity: 0.8; border-radius: 4px; margin-right: 8px;"></span>Predicted</span>
                <span><span style="display: inline-block; width: 16px; height: 16px; border: 2px solid #5a67d8; border-radius: 4px; margin-right: 8px;"></span>Today</span>
            </div>
        </div>

        <div class="card">
            <h2>Your Cycle Stats</h2>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-value" id="avgCycle">--</span>
                    <div class="stat-label">Avg Cycle Length</div>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="avgPeriod">--</span>
                    <div class="stat-label">Avg Period Length</div>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="nextPeriod">--</span>
                    <div class="stat-label">Next Period</div>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="daysSince">--</span>
                    <div class="stat-label">Days Since Last</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>Manual Entry</h2>
            <p style="color: #718096; margin-bottom: 20px;">Or use manual date entry if you prefer:</p>
            <div class="input-group">
                <input type="date" id="startDate" required>
                <input type="date" id="endDate" required>
                <button onclick="addPeriod()">Add Period</button>
            </div>
        </div>

        <div class="card">
            <h2>Period History</h2>
            <div id="periodHistory"></div>
        </div>

        <div class="card">
            <h2>Data & Sharing</h2>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                <button onclick="exportData()" style="flex: 1; min-width: 120px; font-size: 14px;">üì§ Export Data</button>
                <button onclick="importData()" style="flex: 1; min-width: 120px; font-size: 14px;">üì• Import Data</button>
                <button onclick="clearAllData()" style="flex: 1; min-width: 120px; font-size: 14px; background: #e53e3e;">üóëÔ∏è Clear All</button>
            </div>
            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImportFile(event)">
            <p style="color: #718096; font-size: 14px; margin-top: 10px;">
                üí° <strong>Sharing with your partner:</strong> Use Export to save your data, then send the file to your partner. They can Import it to see your cycle data.
            </p>
        </div>
    </div>

    <script>
        // Simple storage: store day numbers with month/year info
        let markedDays = {}; // Format: "2025-08": [4, 6, 8]
        let currentCalendarMonth = new Date().getMonth();
        let currentCalendarYear = new Date().getFullYear();

        function getMonthKey(year, month) {
            return `${year}-${String(month + 1).padStart(2, '0')}`;
        }

        function getCurrentMonthKey() {
            return getMonthKey(currentCalendarYear, currentCalendarMonth);
        }

        function togglePeriodDay(dayNumber) {
            const monthKey = getCurrentMonthKey();
            
            if (!markedDays[monthKey]) {
                markedDays[monthKey] = [];
            }
            
            const index = markedDays[monthKey].indexOf(dayNumber);
            if (index > -1) {
                markedDays[monthKey].splice(index, 1);
                if (markedDays[monthKey].length === 0) {
                    delete markedDays[monthKey];
                }
            } else {
                markedDays[monthKey].push(dayNumber);
                markedDays[monthKey].sort((a, b) => a - b);
            }
            
            updateDisplay();
        }

        function addPeriod() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            if (!startDate || !endDate) {
                alert('Please select both start and end dates');
                return;
            }

            if (new Date(startDate) > new Date(endDate)) {
                alert('Start date must be before end date');
                return;
            }

            // Add all days in the range
            const start = new Date(startDate);
            const end = new Date(endDate);
            const currentDate = new Date(start);
            
            while (currentDate <= end) {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                const day = currentDate.getDate();
                const monthKey = getMonthKey(year, month);
                
                if (!markedDays[monthKey]) {
                    markedDays[monthKey] = [];
                }
                
                if (!markedDays[monthKey].includes(day)) {
                    markedDays[monthKey].push(day);
                    markedDays[monthKey].sort((a, b) => a - b);
                }
                
                currentDate.setDate(currentDate.getDate() + 1);
            }

            // Clear form
            document.getElementById('startDate').value = '';
            document.getElementById('endDate').value = '';

            updateDisplay();
        }

        function previousMonth() {
            currentCalendarMonth--;
            if (currentCalendarMonth < 0) {
                currentCalendarMonth = 11;
                currentCalendarYear--;
            }
            updateCalendar();
        }

        function nextMonth() {
            currentCalendarMonth++;
            if (currentCalendarMonth > 11) {
                currentCalendarMonth = 0;
                currentCalendarYear++;
            }
            updateCalendar();
        }

        function updateDisplay() {
            updateHistory();
            updateStats();
            updateCalendar();
        }

        function getAllPeriodGroups() {
            // Convert markedDays to sorted list of all dates
            const allDates = [];
            
            Object.keys(markedDays).forEach(monthKey => {
                const [year, month] = monthKey.split('-');
                markedDays[monthKey].forEach(day => {
                    allDates.push({
                        year: parseInt(year),
                        month: parseInt(month) - 1, // Convert back to 0-indexed
                        day: day,
                        date: new Date(parseInt(year), parseInt(month) - 1, day)
                    });
                });
            });
            
            // Sort by date
            allDates.sort((a, b) => a.date - b.date);
            
            if (allDates.length === 0) return [];
            
            // Group dates that are within 7 days of each other
            const groups = [];
            let currentGroup = [allDates[0]];
            
            for (let i = 1; i < allDates.length; i++) {
                const prevDate = allDates[i - 1].date;
                const currentDate = allDates[i].date;
                const dayDiff = (currentDate - prevDate) / (1000 * 60 * 60 * 24);
                
                if (dayDiff <= 7) {
                    currentGroup.push(allDates[i]);
                } else {
                    groups.push(currentGroup);
                    currentGroup = [allDates[i]];
                }
            }
            
            groups.push(currentGroup);
            return groups.reverse(); // Newest first
        }

        function updateHistory() {
            const historyDiv = document.getElementById('periodHistory');
            const groups = getAllPeriodGroups();
            
            if (groups.length === 0) {
                historyDiv.innerHTML = '<div class="empty-state">No periods logged yet. Click on calendar days to mark your period!</div>';
                return;
            }

            historyDiv.innerHTML = groups.map((group, index) => {
                const firstDay = group[0];
                const lastDay = group[group.length - 1];
                const markedCount = group.length;
                
                let dateDisplay;
                if (markedCount === 1) {
                    dateDisplay = `${firstDay.month + 1}/${firstDay.day}/${firstDay.year}`;
                } else {
                    dateDisplay = `${firstDay.month + 1}/${firstDay.day}/${firstDay.year} to ${lastDay.month + 1}/${lastDay.day}/${lastDay.year}`;
                }
                
                return `
                    <div class="period-entry">
                        <div>
                            <strong>${dateDisplay}</strong>
                            <span style="color: #718096; margin-left: 10px;">(${markedCount} marked day${markedCount === 1 ? '' : 's'})</span>
                        </div>
                        <button class="delete-btn" onclick="deleteGroup(${index})">Delete</button>
                    </div>
                `;
            }).join('');
        }

        function deleteGroup(groupIndex) {
            const groups = getAllPeriodGroups();
            const group = groups[groupIndex];
            
            // Remove all days in this group
            group.forEach(dayObj => {
                const monthKey = getMonthKey(dayObj.year, dayObj.month);
                if (markedDays[monthKey]) {
                    const index = markedDays[monthKey].indexOf(dayObj.day);
                    if (index > -1) {
                        markedDays[monthKey].splice(index, 1);
                        if (markedDays[monthKey].length === 0) {
                            delete markedDays[monthKey];
                        }
                    }
                }
            });
            
            updateDisplay();
        }

        function updateStats() {
            const avgCycleEl = document.getElementById('avgCycle');
            const avgPeriodEl = document.getElementById('avgPeriod');
            const nextPeriodEl = document.getElementById('nextPeriod');
            const daysSinceEl = document.getElementById('daysSince');

            const groups = getAllPeriodGroups();

            if (groups.length === 0) {
                avgCycleEl.textContent = '--';
                avgPeriodEl.textContent = '--';
                nextPeriodEl.textContent = '--';
                daysSinceEl.textContent = '--';
                return;
            }

            // Calculate average period length using start to end date span
            const periodLengths = groups.map(group => {
                const startDate = group[0].date;
                const endDate = group[group.length - 1].date;
                return Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
            });
            const avgPeriodLength = Math.round(periodLengths.reduce((sum, length) => sum + length, 0) / periodLengths.length);
            avgPeriodEl.textContent = `${avgPeriodLength} days`;

            // Average cycle length and predictions
            if (groups.length > 1) {
                const sortedGroups = [...groups].reverse(); // oldest first
                const cycleLengths = [];
                for (let i = 1; i < sortedGroups.length; i++) {
                    const prevStart = sortedGroups[i-1][0].date;
                    const currentStart = sortedGroups[i][0].date;
                    const cycleLength = Math.ceil((currentStart - prevStart) / (1000 * 60 * 60 * 24));
                    cycleLengths.push(cycleLength);
                }
                const avgCycleLength = Math.round(cycleLengths.reduce((a, b) => a + b, 0) / cycleLengths.length);
                avgCycleEl.textContent = `${avgCycleLength} days`;

                // Predict next period
                const lastPeriodStart = groups[0][0].date;
                const nextPeriodDate = new Date(lastPeriodStart);
                nextPeriodDate.setDate(nextPeriodDate.getDate() + avgCycleLength);
                nextPeriodEl.textContent = `${nextPeriodDate.getMonth() + 1}/${nextPeriodDate.getDate()}/${nextPeriodDate.getFullYear()}`;
            } else {
                avgCycleEl.textContent = '--';
                nextPeriodEl.textContent = '--';
            }

            // Days since last period
            const lastGroup = groups[0];
            const lastDay = lastGroup[lastGroup.length - 1];
            const today = new Date();
            const daysSince = Math.floor((today - lastDay.date) / (1000 * 60 * 60 * 24));
            daysSinceEl.textContent = `${daysSince} days`;
        }

        function getPredictedDays() {
            const groups = getAllPeriodGroups();
            
            if (groups.length < 2) return [];
            
            // Calculate averages
            const sortedGroups = [...groups].reverse(); // oldest first
            const cycleLengths = [];
            for (let i = 1; i < sortedGroups.length; i++) {
                const prevStart = sortedGroups[i-1][0].date;
                const currentStart = sortedGroups[i][0].date;
                const cycleLength = Math.ceil((currentStart - prevStart) / (1000 * 60 * 60 * 24));
                cycleLengths.push(cycleLength);
            }
            
            if (cycleLengths.length === 0) return [];
            
            const avgCycleLength = Math.round(cycleLengths.reduce((a, b) => a + b, 0) / cycleLengths.length);
            
            const periodLengths = groups.map(group => {
                const startDate = group[0].date;
                const endDate = group[group.length - 1].date;
                return Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;
            });
            const avgPeriodLength = Math.round(periodLengths.reduce((sum, length) => sum + length, 0) / periodLengths.length);
            
            // Find predicted start date
            const lastPeriodStart = groups[0][0].date;
            const predictedStart = new Date(lastPeriodStart);
            predictedStart.setDate(predictedStart.getDate() + avgCycleLength);
            
            // Generate predicted days for current viewing month
            const predictedDays = [];
            for (let i = 0; i < avgPeriodLength; i++) {
                const predictedDay = new Date(predictedStart);
                predictedDay.setDate(predictedDay.getDate() + i);
                
                if (predictedDay.getMonth() === currentCalendarMonth && 
                    predictedDay.getFullYear() === currentCalendarYear) {
                    predictedDays.push(predictedDay.getDate());
                }
            }
            
            return predictedDays;
        }

        function updateCalendar() {
            const calendar = document.getElementById('calendar');
            const monthYearEl = document.getElementById('currentMonthYear');
            const today = new Date();

            // Set month/year header
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
            monthYearEl.textContent = `${monthNames[currentCalendarMonth]} ${currentCalendarYear}`;

            // Get marked days for current month and predicted days
            const currentMonthKey = getCurrentMonthKey();
            const currentMonthMarkedDays = markedDays[currentMonthKey] || [];
            const predictedDays = getPredictedDays();

            // Create calendar
            const firstDay = new Date(currentCalendarYear, currentCalendarMonth, 1);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            calendar.innerHTML = '';

            // Add day headers
            const dayHeaders = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-header';
                header.textContent = day;
                calendar.appendChild(header);
            });

            // Add calendar days
            const currentDate = new Date(startDate);
            for (let i = 0; i < 42; i++) {
                const dayEl = document.createElement('div');
                dayEl.className = 'calendar-day';
                dayEl.textContent = currentDate.getDate();

                const isCurrentMonth = currentDate.getMonth() === currentCalendarMonth;
                const dayNumber = currentDate.getDate();
                
                if (!isCurrentMonth) {
                    dayEl.classList.add('other-month');
                } else {
                    // Add click listener only for current month days
                    dayEl.addEventListener('click', () => togglePeriodDay(dayNumber));
                    
                    // Check if this day is marked
                    if (currentMonthMarkedDays.includes(dayNumber)) {
                        dayEl.classList.add('period-day');
                    } 
                    // Check if this day is predicted (and not already marked)
                    else if (predictedDays.includes(dayNumber)) {
                        dayEl.classList.add('predicted-day');
                    }
                }

                // Check if today
                if (currentDate.toDateString() === today.toDateString()) {
                    dayEl.classList.add('today');
                }

                calendar.appendChild(dayEl);
                currentDate.setDate(currentDate.getDate() + 1);
            }
        }

        // Export data for sharing
        function exportData() {
            const data = {
                markedDays: markedDays,
                exportDate: new Date().toISOString(),
                version: "1.0"
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            // Create download link
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `period-tracker-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            // Show success message
            alert('‚úÖ Data exported! Share this file with your partner.');
        }

        // Import data from partner
        function importData() {
            document.getElementById('importFile').click();
        }

        function handleImportFile(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.markedDays) {
                        // Merge with existing data
                        Object.keys(data.markedDays).forEach(monthKey => {
                            if (!markedDays[monthKey]) {
                                markedDays[monthKey] = [];
                            }
                            
                            data.markedDays[monthKey].forEach(day => {
                                if (!markedDays[monthKey].includes(day)) {
                                    markedDays[monthKey].push(day);
                                }
                            });
                            
                            markedDays[monthKey].sort((a, b) => a - b);
                        });
                        
                        updateDisplay();
                        alert('‚úÖ Data imported successfully!');
                    } else {
                        alert('‚ùå Invalid file format');
                    }
                } catch (error) {
                    alert('‚ùå Error reading file: ' + error.message);
                }
            };
            
            reader.readAsText(file);
            
            // Reset file input
            event.target.value = '';
        }

        // Clear all data
        function clearAllData() {
            if (confirm('‚ö†Ô∏è Are you sure you want to delete all period data? This cannot be undone.')) {
                markedDays = {};
                updateDisplay();
                alert('‚úÖ All data cleared');
            }
        }

        // Initialize the app
        updateDisplay();
    </script>
</body>
</html>
